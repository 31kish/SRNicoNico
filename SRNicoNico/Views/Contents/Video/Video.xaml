<UserControl x:Class="SRNicoNico.Views.Contents.Video.Video"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mui="http://firstfloorsoftware.com/ModernUI"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:l="http://schemas.livet-mvvm.net/2011/wpf"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:SRNicoNico.ViewModels"
             xmlns:video="clr-namespace:SRNicoNico.Views.Contents.Video"
             xmlns:bc="http://www.quickzip.org/BaseControls"
             xmlns:behaviors="clr-namespace:SRNicoNico.Views.Behaviors"
             d:DesignHeight="600"
             d:DesignWidth="825"
			 d:DataContext="{d:DesignInstance {x:Type vm:VideoViewModel}}"
             mc:Ignorable="d"
             Focusable="False"
             DataContextChanged="UserControl_DataContextChanged">

    <i:Interaction.Triggers>

        <l:InteractionMessageTrigger Messenger="{Binding Messenger}">
            <l:TransitionInteractionMessageAction/>
        </l:InteractionMessageTrigger>

        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="F">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="GoToFullScreen" />
        </ei:KeyTrigger>
        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="Space">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="PlayOrPauseOrResume" />
        </ei:KeyTrigger>
        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="Left">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="Restart" />
        </ei:KeyTrigger>
        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="C">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="ToggleComment" />
        </ei:KeyTrigger>
        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="R">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="ToggleRepeat" />
        </ei:KeyTrigger>
        <ei:KeyTrigger FiredOn="KeyUp" ActiveOnFocus="True" Key="M">
            <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="ToggleMute" />
        </ei:KeyTrigger>
    </i:Interaction.Triggers>



    <Grid x:Name="Grid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="150"/>
            <ColumnDefinition Width="46*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="154*"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="113*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.RowSpan="2" Margin="10" >

            <Border BorderBrush="#FF444444" BorderThickness="1">
                <StackPanel Margin="3">
                    <TextBlock Margin="2" TextWrapping="Wrap" Text="{Binding VideoData.ApiData.Cmsid, StringFormat=動画ID : {0}}" VerticalAlignment="Top" />
                    <TextBlock Margin="2" TextWrapping="Wrap" Text="{Binding VideoData.ApiData.ViewCounter, StringFormat=再生数 : {0:N0}}" VerticalAlignment="Top" />
                    <TextBlock Margin="2" TextWrapping="Wrap" Text="{Binding VideoData.ApiData.CommentCounter, StringFormat=コメント数 : {0:N0}}" VerticalAlignment="Top" />
                    <TextBlock Margin="2" TextWrapping="Wrap" Text="{Binding VideoData.ApiData.MylistCounter, StringFormat=マイリスト数 : {0:N0}}" VerticalAlignment="Top" />
                </StackPanel>
            </Border>
           
           


        </StackPanel>



        <TextBlock HorizontalAlignment="Left" Grid.Row="0" Grid.Column="1" TextWrapping="NoWrap" FontSize="20" Text="{Binding VideoData.ApiData.Title}" VerticalAlignment="Top"/>

        <mui:ModernButton HorizontalAlignment="Right" IconData="F1 M 26.9166,22.1667L 37.9999,33.25L 49.0832,22.1668L 53.8332,26.9168L 42.7499,38L 53.8332,49.0834L 49.0833,53.8334L 37.9999,42.75L 26.9166,53.8334L 22.1666,49.0833L 33.25,38L 22.1667,26.9167L 26.9166,22.1667 Z" Margin="0,0,10,0" Grid.Column="1" >

            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Click">
                    <l:LivetCallMethodAction MethodTarget="{Binding}" MethodName="DisposeViewModel" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </mui:ModernButton>

        <video:VideoFlash Grid.Row="1" Grid.Column="1" />
        <video:VideoController x:Name="Controller"  Grid.Row="2" Grid.Column="1" />

        <Grid Grid.Row="3" Grid.Column="1" >

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="200"/>
            </Grid.ColumnDefinitions>

            <ScrollViewer>
                <Grid>
                    <TextBlock HorizontalAlignment="Stretch"  Padding="5" TextWrapping="Wrap" behaviors:HtmlTextBoxProperties.TriggerRequest="TextBlock_TriggerRequest"  behaviors:HtmlTextBoxProperties.HtmlText="{Binding VideoData.ApiData.Description, Mode=OneWay}" />
                    <mui:ModernProgressRing Grid.Row="2" HorizontalAlignment="Center" Panel.ZIndex="2" Width="50" Height="50" Foreground="#FFAAAAAA" IsActive="{Binding IsActive}"  />

                </Grid>

            </ScrollViewer>
            <Border Grid.Column="2" BorderBrush="#FF444444" BorderThickness="1" Margin="0,10,0,0" >
                <StackPanel Margin="3">

                    <TextBlock Text="タグ" Margin="10" FontSize="16" />

                    <Rectangle Stroke="#FF444444" Margin="10,-5,10,5" />

                    <ListView Margin="10" ItemsSource="{Binding VideoData.ApiData.TagList}" Focusable="False" >
                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListViewItem}">
                                
                                <Setter Property="Focusable" Value="False" />
                                <Setter Property="Foreground" Value="#FFAAAAAA" />
                            </Style>
                        </ListView.ItemContainerStyle>

                        <ListView.Resources>
                            <DataTemplate DataType="{x:Type vm:VideoTagViewModel}">
                                <video:VideoTag />
                            </DataTemplate>
                        </ListView.Resources>
                    </ListView>
                </StackPanel>
            </Border>
        </Grid>




    </Grid>



</UserControl>
